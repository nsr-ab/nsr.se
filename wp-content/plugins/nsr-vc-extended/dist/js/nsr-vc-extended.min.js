var VcExtended=VcExtended||{};VcExtended.NSRExtend=VcExtended.NSRExtend||{},VcExtended.NSRExtend.Extended=function(t){function e(){this.init(),t(".card-content").matchHeight()}var n=null,a=200,i=[];return e.prototype.init=function(){t("body").on("click",".showAllPosts",function(){e.prototype.displayMore(this)}).bind(this),t("body").on("click",".searchArea *",function(t){e.prototype.fullScreen(t)}).bind(this),t("body").on("click",".closeSearch",function(t){e.prototype.closeScreen(this)}).bind(this),t.fn.enterKey=function(t){e.prototype.enterTrigger(t,this)},t(".searchNSR").enterKey(function(){event.preventDefault(),window.clearTimeout(n),e.prototype.doneTyping()}),t(".searchNSR").on("input",function(){window.clearTimeout(n),n=window.setTimeout(e.prototype.doneTyping,a)}),t(".searchNSR").on("keydown",function(t){e.prototype.haltTimer(t,n)}),t("body").on("click",".locationmap",function(){window.open(t(this).data("url"),"_blank")}).bind(this)},e.prototype.encodeStr=function(t){return t.split("").reduce(function(t,e){return t=(t<<5)-t+e.charCodeAt(0),t&t},0)},e.prototype.displayMore=function(e){if(event.preventDefault(),t(e).closest("ul").find("li").hasClass("hide")){t(e).closest("ul").find(".hide").addClass("show"),t(e).closest("ul").find("li").removeClass("hide");var n=t(e).closest("ul").find("li").length-6;t(e).closest("ul").find(".showPosts").text("Dölj ("+n+")")}else{t(e).closest("ul").find(".show").addClass("hide"),t(e).closest("ul").find("li").removeClass("show");var a=t(e).closest("ul").find("li").length-1;t(e).closest("ul").find(".showPosts").text("Visa alla ("+a+")")}t(".card-content").matchHeight()},e.prototype.enterTrigger=function(e,n){return n.each(function(){t(n).keypress(function(a){var i=a.keyCode?a.keyCode:a.which;if("13"==i)return t(".search-autocomplete").remove(),t(".sorteringsguiden").remove(),e.call(n,a),event.preventDefault(),!1})})},e.prototype.closeScreen=function(e){event.stopPropagation(),t(".searchNSR").removeClass("fullscreen"),t(e).addClass("hide"),t("#searchResult").html(""),t("#searchkeyword-nsr").val(""),t(".search-autocomplete").remove(),t(".sorteringsguiden").remove()},e.prototype.haltTimer=function(t,e){switch(t.which){case 32:window.clearTimeout(e);break;case 8:window.clearTimeout(e)}},e.prototype.fullScreen=function(e){return t(e.target).is("i")||t(e.target).is(".search-autocomplete")?void e.preventDefault():(t(".searchNSR input").focus(),t(".searchNSR").addClass("fullscreen"),t(".closeSearch").removeClass("hide"),void event.stopPropagation())},e.prototype.doneTyping=function(){t(".searchNSR").each(function(t,n){e.prototype.autocomplete(n)})},e.prototype.autocomplete=function(e){var n=t(e),a=n.find('input[type="search"]');a.val().length<2||this.autocompleteQuery(e)},e.prototype.autocompleteSubmit=function(e){var n=t(e),a=n.find(".search-autocomplete"),i=a.find(".selected");return!i.length||(location.href=i.find("a").attr("href"),!1)},e.prototype.autocompleteQuery=function(e){var n=t(e),a=n.find('input[type="search"]').val(),i=t("#post_type").val(),o={action:"fetch_data",query:a,post_type:i,level:"ajax",type:"json"};t.ajax({url:ajax_object.ajax_url,data:o,method:"GET",dataType:"json",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",ajax_object.nonce)}}).done(function(t){n.find(".sorteringsguiden").remove(),n.find(".search-autocomplete").remove(),this.outputAutocomplete(e,t,i)}.bind(this))},e.prototype.metaDataStr=function(t){var e=new Array;switch(t){case"post":e.postSection="Nyheter",e.icon="chat";break;case"fastighet":e.postSection="Fastighetsägare & Bostadsrättsföreningar",e.icon="location_city";break;case"villa":e.postSection="Villa & Fritidsboende",e.icon="home";break;case"foretag":e.postSection="Företag & Restauranger",e.icon="domain";break;case"page":e.postSection="Sidor",e.icon="insert_drive_file";break;case"faq":e.postSection="Frågor & svar",e.icon="forum";break;case"sorteringsguide":e.postSection="Sorteringsguiden",e.icon="delete"}return""===e.icon&&(e.icon="find_in_page"),e},e.prototype.outputAutocomplete=function(n,a,o){var l=t(n),s=t('<div class="search-autocomplete"><h4>Sidor på nsr.se</h4></div>'),r=t('<ul class="search-autocomplete-content"></ul>'),c=t('<div class="sorteringsguiden"><h4>Sorteringsguiden</h4><div class="left badgeInfo"><span class="badge">P</span> Privat <span class="badge">F</span> Företag<br /></div></div>'),d='<div class="preloader-wrapper small active hide"> <div class="spinner-layer spinner-white-only"> <div class="circle-clipper left"> <div class="circle"></div> </div><div class="gap-patch"> <div class="circle"></div> </div><div class="circle-clipper right"> <div class="circle"></div> </div> </div> </div> ',p=t('<table class="sorterings-guide-table"><tr class="tabDesk"><th></th><th>Sorteras som</th><th class="relative">'+d+'Lämna nära dig... </th><th class="exnfodispl">Bra att veta</th></tr></table>');if("undefined"!=typeof a.sortguide&&null!==a.sortguide&&a.sortguide.length>0){var u,f,h="",m="",v=0;t.each(a.sortguide,function(t,e){var n="";if(e.post_meta&&(e.post_meta.avfall_kundkategori[0].indexOf("villa")>=0&&(n+='<span class="badge sortSectionIcon private">P</span> '),e.post_meta.avfall_kundkategori[0].indexOf("foretag")>=0&&(n+='<span class="badge sortSectionIcon company">F</span>')),u+='<tr class="tabMobile"><th>Avfall:</th><td valign="top">'+e.post_title+' <div class="badgecontainer">'+n+"</div></td></tr>",u+='<tr class="tabDesk"><td class="preSortCell" valign="top">'+e.post_title+' <div class="badgecontainer">'+n+'</div></td><td valign="top">',e.terms){if(e.post_meta.avfall_fraktion&&e.post_meta.avfall_fraktion.length&&""!=e.post_meta.avfall_fraktion_hemma){for(u+='<li><b>Återvinningscentral:</b><ul class="sortAs meta-fraktion">',h+="<li><b>Sorteras som på ÅVC:</b><ul>",int=0;int<e.post_meta.avfall_fraktion.length;int++)u+="<li>"+e.post_meta.avfall_fraktion[int]+"</li>",h+="<li>"+e.post_meta.avfall_fraktion[int]+"<li>";u+="</ul></li>",h+="</ul></li>"}if(e.post_meta.avfall_fraktion_hemma&&e.post_meta.avfall_fraktion_hemma.length&&""!=e.post_meta.avfall_fraktion_hemma){for(u+='<li><b>Hemma:</b><ul class="meta-fraktion">',h+='<li><b class="sortAs">Sorteras som hemma:</b><ul>',int=0;int<e.post_meta.avfall_fraktion_hemma.length;int++)u+="<li>"+e.post_meta.avfall_fraktion_hemma[int]+"</li>",h+="<li>"+e.post_meta.avfall_fraktion_hemma[int]+"<li>";u+="</ul></li>",h+="</ul></li>"}}if(u+='</td><td valign="top"><ul>',e.terms&&e.terms.inlamningsstallen&&e.terms.inlamningsstallen.length){for(f=[],int=0;int<e.terms.inlamningsstallen.length;int++)if(int<=5){var a,o=e.terms.inlamningsstallen[int].term_id+"-"+int;e.terms.inlamningsstallen[int].pageurl&&(a=' data-url="http://maps.google.com?q='+e.terms.inlamningsstallen[int].lat+","+e.terms.inlamningsstallen[int]["long"]+'" '),f[int]=[e.terms.inlamningsstallen[int].city,e.terms.inlamningsstallen[int].lat,e.terms.inlamningsstallen[int]["long"],e.terms.inlamningsstallen[int].name,o],u+='<li class="cord-'+o+' locationmap" '+a+'><i class="material-icons isize">location_on</i> '+e.terms.inlamningsstallen[int].name+"</li>",m+='<li class="cord-'+o+' locationmap" '+a+'><i class="material-icons isize">location_on</i> '+e.terms.inlamningsstallen[int].name+"</li>"}i[v]=f,v++}u+="</ul></td>";var l;e.post_meta&&(l=e.post_meta.avfall_bra_att_veta),u+='<td class="exnfodispl">'+l+"</td>",u+="</tr>",u+='<tr class="tabMobile"><th>Sorteras:</th><td><ul class="meta-fraktion">'+h+"</ul></td></tr>",u+='<tr class="tabMobile"><th>Lämnas:</th><td><ul>'+m+"</ul></td></tr>",u+='<tr class="tabMobile lastchild"><td class="lastchild" colspan="2"> </td></tr>',m=""}),p.append(u)}e.prototype.metaDataStr("sorteringsguide");"undefined"!=typeof a.content&&null!==a.content&&a.content.length>0?t.each(a.content,function(t,n){var a=n.post_excerpt.replace(/^(.{180}[^\s]*).*/,"$1");a&&(a+="...");var i=e.prototype.metaDataStr(n.post_type);i.icon||(i.icon="find_in_page");var o='<li class="collapsible-header col s12 m12 l12"> <i class="material-icons"> '+i.icon+'</i><a href="'+n.guid+'">'+n.post_title+'<span class="section right">'+i.postSection+"</span>";a&&(o+='<div class="moreinfo">'+a+"</div>"),o+="</a></li>",r.append(o)}):r=t(""),p.appendTo(c),c.appendTo(l),r.appendTo(s),s.appendTo(l).show(),navigator.geolocation&&(t(".preloader-wrapper").fadeIn("slow"),navigator.geolocation.getCurrentPosition(e.prototype.UserLocation))},e.prototype.UserLocation=function(t){e.prototype.NearestCity(t.coords.latitude,t.coords.longitude)},e.prototype.Deg2Rad=function(t){return t*Math.PI/180},e.prototype.PythagorasEquirectangular=function(t,n,a,i){t=e.prototype.Deg2Rad(t),a=e.prototype.Deg2Rad(a),n=e.prototype.Deg2Rad(n),i=e.prototype.Deg2Rad(i);var o=6371,l=(i-n)*Math.cos((t+a)/2),s=a-t,r=Math.sqrt(l*l+s*s)*o;return r},e.prototype.NearestCity=function(n,a){for(ind=0;ind<i.length;++ind)if(ind<i.length+1){t(r).closest("ul").addClass("parent-"+ind);var o,l=99999;for(index=0;index<i[ind].length;++index){var s=e.prototype.PythagorasEquirectangular(n,a,i[ind][index][1],i[ind][index][2]);if(s<l){o=ind,l=s;var r=".cord-"+i[ind][index][4]}}t(r).css("font-weight","600"),t(r).css("color","#fff"),t(r).find("i").css("color","#00ffd0"),icn=!1,r=!1}return t(".preloader-wrapper").fadeOut("slow"),i[o]},new e}(jQuery);var VcExtended=VcExtended||{};VcExtended.MenuCollapsibleAdmin=VcExtended.MenuCollapsibleAdmin||{},VcExtended.MenuCollapsibleAdmin.CollapsibleAdmin=function(t){function e(){this.init()}return e.prototype.init=function(){t(function(){this.eventHandler()}.bind(this)),this.colorPickerDefaultColors()},e.prototype.eventHandler=function(){var n=null;t("body").on("keyup",".vcext_search_pagetitle",function(){clearTimeout(n);var a=t(this).val();n=setTimeout(function(){e.prototype.fetchDataByKeyword({query:a})},500)}).bind(this),t("body").on("change",".vc_all_locations",function(e){t(".vc_location").val("Välj Stad/Ort...").change(),t(".vc_date_size").val("Välj format...").change(),t(".vc_type").val("Välj visningstyp...").change()}).bind(this)},e.prototype.fetchDataByKeyword=function(t){var e={action:"fetch_data",query:t.query};jQuery.post(ajax_object.ajax_url,e,function(t){console.log(jQuery.parseJSON(t))})},e.prototype.colorPickerDefaultColors=function(){jQuery(document).ready(function(t){"object"==typeof t.wp&&"function"==typeof t.wp.wpColorPicker&&(t.wp.wpColorPicker.prototype.options={palettes:["#75a3eb","#6d7dcc","#a27ac3","#fe0e35","#00aaff","#00f2d3"],hide:!0})})},new e}(jQuery);var callbackOutsideScope=function(){},VcExtended=VcExtended||{};VcExtended.MenuCollapsible=VcExtended.MenuCollapsible||{},VcExtended.MenuCollapsible.Collapsible=function(t){function e(){this.init()}return e.prototype.init=function(){t(function(){this.eventHandler()}.bind(this))},e.prototype.eventHandler=function(){t("body").on("click",".collapsible-header",function(){$id=t(this).parents("ul").attr("id"),0===t(this).find("a").length?(t($id).find(".materialIconState").text("add"),t(this).hasClass("active")?t(this).find(".materialIconState").text("clear"):t(this).find(".materialIconState").text("add")):window.location.href=t(this).find("a").attr("href")}).bind(this)},new e}(jQuery);