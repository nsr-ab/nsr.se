var VcExtended=VcExtended||{};VcExtended.NSRExtend=VcExtended.NSRExtend||{},VcExtended.NSRExtend.Extended=function(e){function t(){this.init()}var o;return t.prototype.init=function(){e("body").on("click",".showAllPosts",function(){if(event.preventDefault(),e(this).closest("ul").find("li").hasClass("hide")){e(this).closest("ul").find(".hide").addClass("show"),e(this).closest("ul").find("li").removeClass("hide");var t=e(this).closest("ul").find("li").length-6;e(this).closest("ul").find(".showPosts").text("Dölj ("+t+")")}else{e(this).closest("ul").find(".show").addClass("hide"),e(this).closest("ul").find("li").removeClass("show");var o=e(this).closest("ul").find("li").length-1;e(this).closest("ul").find(".showPosts").text("Visa alla ("+o+")")}}).bind(this);var o=null;e("body").on("click",".searchArea *",function(t){return e(t.target).is("i")||e(t.target).is(".search-autocomplete")?void t.preventDefault():(e(".searchNSR input").focus(),e(".searchNSR").addClass("fullscreen"),e(".closeSearch").removeClass("hide"),void event.stopPropagation())}).bind(this),e("body").on("click",".closeSearch",function(t){event.stopPropagation(),e(".searchNSR").removeClass("fullscreen"),e(this).addClass("hide"),e("#searchResult").html(""),e("#searchkeyword-nsr").val(""),e(".search-autocomplete").remove(),e(".sorteringsguiden").remove()}).bind(this),e.fn.enterKey=function(t){return this.each(function(){e(this).keypress(function(o){var n=o.keyCode?o.keyCode:o.which;if("13"==n)return e(".search-autocomplete").remove(),e(".sorteringsguiden").remove(),t.call(this,o),event.preventDefault(),!1})})},e(".searchNSR").enterKey(function(){e(".searchNSR").append('<div id="searchResult"></div>'),clearTimeout(o);var n=e(this).val(),i=e("#post_type").val();o=setTimeout(function(){t.prototype.siteSearch({query:n,post_type:i})},200)}).bind(this),e(".search").each(function(t,o){e("#searchResult").html(""),this.autocomplete(o),e(".searchNSR").find('input[type="search"]').is(":empty")&&(e(".search-autocomplete").remove(),e(".sorteringsguiden").remove())}.bind(this)),e("body").on("click",".read-more",function(){var o=e(".searchNSR").find('input[type="search"]').val(),n=e("#post_type").val();t.prototype.siteSearch({query:o,post_type:n})})},t.prototype.siteSearch=function(t){e("#searchResult").html("");var o=(t.query,t.post_type,{action:"fetch_data",query:t.query+"&post_type"+t.post_type,limit:18});e.ajax({url:ajax_object.ajax_url,data:o,method:"GET",dataType:"json",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ajax_object.nonce)}}).done(function(e){this.searchOutput(e)}.bind(this))},t.prototype.postIcon=function(e){switch(e){case"post":$icon="chat";break;case"fastighet":$icon="location_city";break;case"villa":$icon="home";break;case"foretag":$icon="domain";break;case"page":$icon="insert_drive_file";break;case"faq":$icon="forum";break;case"sorteringsguide":$icon="delete"}return $icon},t.prototype.searchOutput=function(o){var n=e('<ul class="search-content"></ul>');"undefined"!=typeof o.content&&null!==o.content&&o.content.length>0&&e.each(o.content,function(e,o){if(o.post_excerpt)var i=o.post_excerpt.replace(/^(.{180}[^\s]*).*/,"$1")+"...";else var i="";switch($icon="find_in_page",o.post_type){case"page":$postSection="Sidor",$icon=t.prototype.postIcon("page");break;case"post":$postSection="Nyheter",$icon=t.prototype.postIcon("post");break;case"fastighet":$postSection="Fastighetsägare & Bostadsrättsföreningar",$icon=t.prototype.postIcon("fastighet");break;case"villa":$postSection="Villa & Fritidsboende",$icon=t.prototype.postIcon("villa");break;case"foretag":$postSection="Företag & Restauranger",$icon=t.prototype.postIcon("foretag");break;default:$postSection=""}n.append('<li class="col s12 m6 l6"> <i class="material-icons"> '+$icon+'</i><a href="'+o.guid+'"><h5>'+o.post_title+'</h5></a><span class="section right">'+$postSection+"</span><p>"+i+"</p></li>")}),e("#searchResult").html(n),e(".search-autocomplete").remove(),e(".search-content li").matchHeight()},t.prototype.autocomplete=function(t){var n=e(t),i=n.find('input[type="search"]');i.on("keydown",function(e){switch(e.which){case 40:return this.autocompleteKeyboardNavNext(t),!1;case 38:return this.autocompleteKeyboardNavPrev(t),!1;case 13:return this.autocompleteSubmit(t)}return clearTimeout(o),i.val().length<2?(n.find(".sorteringsguiden").remove(),void n.find(".search-autocomplete").remove()):void(o=setTimeout(function(){this.autocompleteQuery(t)}.bind(this),300))}.bind(this)),e(document).on("click",function(t){e(t.target).closest(".search-autocomplete").length||e(".search-autocomplete").remove()}),i.on("focus",function(e){i.val().length<2||this.autocompleteQuery(t)}.bind(this))},t.prototype.autocompleteSubmit=function(t){var o=e(t),n=o.find(".search-autocomplete"),i=n.find(".selected");if(!i.length)return!0;var a=i.find("a").attr("href");return location.href=a,!1},t.prototype.autocompleteKeyboardNavNext=function(t){var o=e(t),n=o.find(".search-autocomplete"),i=n.find(".selected"),a=null;if(a=i.length?i.next("li:not(.title):first"):n.find("li:not(.title):first"),!a.length){var s=i.parents("ul").next("ul");s.length&&(a=s.find("li:not(.title):first"))}i.removeClass("selected"),a.addClass("selected")},t.prototype.autocompleteKeyboardNavPrev=function(t){var o=e(t),n=o.find(".search-autocomplete"),i=n.find(".selected"),a=null;if(a=i.length?i.prev("li:not(.title)"):n.find("li:not(.title):last"),!a.length){var s=i.parents("ul").prev("ul");s.length&&(a=s.find("li:not(.title):last"))}i.removeClass("selected"),a.addClass("selected")},t.prototype.autocompleteQuery=function(t){for(var o=e(t),n=o.find('input[type="search"]').val(),i=e("#post_type").val(),a=[i,"sorteringsguide"],s=0;s<a.length;s++){var r=a[s];"sorteringsguide"===r&&(i="sorteringsguide");var c={action:"fetch_data",query:n,post_type:i,level:"ajax",type:"json"};e.ajax({url:ajax_object.ajax_url,data:c,method:"GET",dataType:"json",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ajax_object.nonce)}}).done(function(n){"sorteringsguide"===r?o.find(".sorteringsguiden").remove():o.find(".search-autocomplete").remove(),this.outputAutocomplete(t,n,r),e(".search-content").remove(),r=""}.bind(this))}},t.prototype.outputAutocomplete=function(o,n,i){console.log(i);var a=e(o),s=e('<div class="search-autocomplete"><h4>Sidor på nsr.se</h4></div>'),r=e('<ul class="search-autocomplete-content"></ul>'),c=e('<div class="sorteringsguiden"><h4>Sorteringsguiden</h4></div>'),l=e('<table class="sorterings-guide-table striped"><tr><th></th><th>Sorteras som</th><th>Lämna nära dig</th><th>Bra att veta</th></tr></table>');return"undefined"!=typeof n.content&&null!==n.content&&n.content.length>0?e.each(n.content,function(e,o){var n=t.prototype.postIcon(o.post_type);if(!n)var n="find_in_page";o.is_file?"sorteringsguide"!=i&&r.append('<li class="col s12 m12 l12"><i class="material-icons"> '+n+'</i><a class="link-item-before" href="'+o.guid+'" target="_blank">'+o.post_title+"</a></li>"):("sorteringsguide"!=i&&r.append('<li class="col s12 m12 l12"> <i class="material-icons"> '+n+'</i><a href="'+o.guid+'">'+o.post_title+"</a></li>"),"sorteringsguide"===i&&l.append("<tr><td>post.post_avfall</td><td>post.post_sorteras</td><td>post.post_inlamning</td><td>post.post_braveta</td></tr>"))}):r=e(""),null===n.content||0===n.content.length?void s.append('<ul><li class="search-autocomplete-nothing-found">Inga träffar…</li></ul>'):("sorteringsguide"!=i&&(r.appendTo(s),s.append('<div class="extNfo"><button class="read-more block-level">'+ajax_object.searchAutocomplete.viewAll+"</a></div>")),"sorteringsguide"===i&&(l.appendTo(c),c.appendTo(a)),"sorteringsguide"!=i&&s.appendTo(a).show(),void e(".search-autocomplete-content li").matchHeight())},new t}(jQuery);var VcExtended=VcExtended||{};VcExtended.MenuCollapsibleAdmin=VcExtended.MenuCollapsibleAdmin||{},VcExtended.MenuCollapsibleAdmin.CollapsibleAdmin=function(e){function t(){this.init()}return t.prototype.init=function(){e(function(){this.eventHandler()}.bind(this)),this.colorPickerDefaultColors()},t.prototype.eventHandler=function(){var o=null;e("body").on("keyup",".vcext_search_pagetitle",function(){clearTimeout(o);var n=e(this).val();o=setTimeout(function(){t.prototype.fetchDataByKeyword({query:n})},500)}).bind(this),e("body").on("change",".vc_all_locations",function(t){e(".vc_location").val("Välj Stad/Ort...").change(),e(".vc_date_size").val("Välj format...").change(),e(".vc_type").val("Välj visningstyp...").change()}).bind(this)},t.prototype.fetchDataByKeyword=function(e){var t={action:"fetch_data",query:e.query};jQuery.post(ajax_object.ajax_url,t,function(e){console.log(jQuery.parseJSON(e))})},t.prototype.colorPickerDefaultColors=function(){jQuery(document).ready(function(e){"object"==typeof e.wp&&"function"==typeof e.wp.wpColorPicker&&(e.wp.wpColorPicker.prototype.options={palettes:["#75a3eb","#6d7dcc","#a27ac3","#fe0e35","#00aaff","#00f2d3"],hide:!0})})},new t}(jQuery);var callbackOutsideScope=function(){},VcExtended=VcExtended||{};VcExtended.MenuCollapsible=VcExtended.MenuCollapsible||{},VcExtended.MenuCollapsible.Collapsible=function(e){function t(){this.init()}return t.prototype.init=function(){e(function(){this.eventHandler()}.bind(this))},t.prototype.eventHandler=function(){e("body").on("click",".collapsible-header",function(){$id=e(this).parents("ul").attr("id"),0===e(this).find("a").length?(e($id).find(".materialIconState").text("add"),e(this).hasClass("active")?e(this).find(".materialIconState").text("clear"):e(this).find(".materialIconState").text("add")):window.location.href=e(this).find("a").attr("href")}).bind(this)},new t}(jQuery);